# Cookie와 session의 등장배경

> HTTP 프로토콜의 특징을 보완하기 위하여 사용한다.

### HTTP 프로토콜 환경의 특징

> 기본적으로 자원 낭비를 줄이기 위해 `connectionless`, `stateless`한 특성을 가진다.

- connectionless : 클라이언트가 요청을 한 후 응답을 받으면 그 연결을 끊어버리는 특징
- stateless : 연결을 끊는 순간 클라이언트-서버의 통신이 끝나며, 상태 정보는 유지하지 않는 특징

# Cookie

> `브라우저 로컬(메모리 혹은 하드디스크)`에 저장되는 `키-값`이 들어있는 작은 데이터파일

- 사용자인증의 유효시간 명시가 가능<br />
  => 유효시간이 정해지면, 브라우저 종료 후에도 인증이 유지됨
- 사용자가 따로 요청하지 않아도 브라우저가 request하면 request header를 넣어서 자동으로 <span style="background-color: orange">서버에 전송</span>

### ⚙️ 동작 방식

1. 클라이언트가 페이지를 요청
2. 서버에서 쿠키 생성
3. HTTP Header에 쿠키를 포함시켜서 응답
4. 쿠키 만료기간이 있을 경우엔 브라우저 종료 후에도 클라이언트에서 보관
5. 같은 요청시에도 HTTP Header에 쿠키를 함께 전송
6. 서버에서 쿠키를 읽고 이전의 상태정보를 변경할 필요가 있을 때, 쿠키를 업데이트하여 변경된 쿠키를 HTTP Header에 포함시켜 응답

### 예시

- 로그인 시 아이디와 비밀번호를 저장하여 자동로그인 할 때
- 쇼핑몰에서의 장바구니 기능
- 팝업창 "다시 보지 않음"
- 광고 정보 트래킹

# Session

> `서버`에서 사용자 정보를 관리하는 방법

- 쿠키를 기반하기 때문에 속도는 쿠키보다 느림
- 서버에서 클라이언트 구분을 위해 `세션ID`(<span style="color: gray">클라이언트가 request를 보내면, 해당 서버의 엔진이 클아이언트에게 부여하는 고유한 ID</span>)를 부여하고 브라우저가 서버에 접속한 후 종료할 때까지 인증상태를 유지
- 접속시간에 제한을 둘 수 있다 => 일정시간 응답이 없을 경우 정보가 유지되지 않도록 설정이 가능
- 사용자 정보를 서버에 두기 때문에 <span style="background-color: orange">쿠키보다 보안성이 좋지만, 사용자량이 늘어날 경우 서버 메모리를 많이 차지하게 됨</span>(성능 저하의 요인)

### ⚙️ 동작 방식

1. 클라이언트가 서버 접속 시, 서버로부터 세션 ID를 발급받음
2. 클라이언트는 세션ID에 대해 쿠키를 사용하여 저장하고 가지고 있음
3. 클라이언트가 서버에 요청 시 쿠키의 세션ID를 같이 서버에 전달하여 요청
4. 서버는 세션ID를 전달받은 후, 세션ID로 세션에 있는 클라이언트 정보를 가져와서 사용
5. 클라이언트 정보를 가지고 서버요청을 처리하여 클라이언트에게 응답

### 예시

- 화면 이동 중에도 로그인이 유지됨 (로그아웃하거나 브라우저를 종료하기 전까지)

# Web-storage

> `클라이언트에 데이터를 저장`할 수 있도록 하는, 쿠키의 부족한 부분을 보완하여 HTML5부터 추가된 저장소

- key-value의 저장형식
- origin(도메인, 프로토콜, 포트) 단위로 접근이 제한되는 특성 때문에 CSRF(<span style="color: gray">Cross Site Reqeust Forgery - 사이트 간 요청 위조</span>)로 부터 안전
- 쿠키와 달리 자동 전송의 위험성이 없음<br />
  => 정보가 항상 서버로 전송되기 때문에 트래픽이 커지는 문제가 있음

## local-storage

> 브라우저에 데이터를 저장

- 사용자가 데이터를 지우지 않는 이상, 브라우저나 OS를 종료해도 브라우저에 남아있는 저장공간(영구성) => 단 동일한 브라우저를 사용할 경우에만.
- `지속적으로 필요한 데이터`를 저장할 때 사용(자동 로그인)

## session-storage

> 각 세션마다 데이터를 개별적으로 저장

- 데이터가 오리진뿐 아니라 브라우저 탭에도 종속되기 때문에, 브라우저 탭을 닫을 경우 제거됨
- `일시적으로 필요한 데이터`를 저장할 때 사용(비회원의 장바구니기능, 입력폼 저장)
